<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>欢迎来到CQUPT Hub</title>

    <meta name="description" content="Source code generated using layoutit.com">
    <meta name="author" content="LayoutIt!">

    <link href="/static/new/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/new/css/style.css" rel="stylesheet">

  </head>
  <body>

    <div class="container-fluid">
	<div class="row">
		<div class="col-md-12">
			<nav class="navbar navbar-expand-lg navbar-light bg-light navbar-dark bg-dark fixed-top">
				 
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
					<span class="navbar-toggler-icon"></span>
				</button> <a class="navbar-brand" href="{{ url_for('index') }}">CQUPT_HUB</a>
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
					<ul class="navbar-nav">
						<li class="nav-item active">
							 <a class="nav-link" href="#">管理员 <span class="sr-only">(current)</span></a>
						</li>
					<ul class="navbar-nav ml-md-auto">
						<li class="nav-item dropdown">
							 <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown">功能栏</a>
							<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
								 <a class="dropdown-item" href="{{ url_for('index') }}">首页</a> 
								 <a class="dropdown-item" href="{{ url_for('admin') }}">管理员界面</a> 
								<div class="dropdown-divider"></div> 
								<a class="dropdown-item" href="{{ url_for('status') }}">近7日签到趋势图</a>
								<a class="dropdown-item" href="{{ url_for('logout') }}">登出</a>
								<a class="dropdown-item" href="{{ url_for('about') }}">关于</a>
							</div>
						</li>
					</ul>
					<form method="GET" action="{{ url_for('admin') }}" class="form-inline">
							<input name="date" class="form-control mr-sm-2" type="date" /> 
							<button class="btn btn-primary my-2 my-sm-0" type="submit">
									按日期搜索
							</button>
						</form>
				</div>
			</nav>
		</div>
	</div>
</div>
<div class="container-fluid">
	<div class="row">
		<div class="col-md-12">
			<div class="row">
				<div class="col-md-12">
					<br><br><br>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="container-fluid">
	<div class="row">
		<div class="col-md-12">
			<div class="tabbable" id="tabs-450645">
				<ul class="nav nav-tabs">
					<li class="nav-item">
						<a class="nav-link active" href="#tab1" data-toggle="tab">今日</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#tab2" data-toggle="tab">已批请假</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#tab3" data-toggle="tab">待批请假</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#tab4" data-toggle="tab">周报</a>
					</li>
				</ul>
				<div class="tab-content">
					<div class="tab-pane active" id="tab1">
						<div class="container-fluid">
							<div class="row">
								<div class="col-md-12">
									<table class="table">
										<thead>
											<tr>
												<th>
													姓名
												</th>
												<th>
													时间
												</th>
												<th>
													记录
												</th>
											</tr>
										</thead>
										<tbody>
											{% for i in myData.sign %}
											<tr class="info">
												<td>
													{{ i.name }}
												</td>
												<td>
													{{ i.time }}
												</td>
												<td>
													<img alt="90x90" height="90" width="90" src="data:image/jpg;base64,{{i.face}}" />
												</td>
											</tr>
											{% endfor %}
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
					<div class="tab-pane" id="tab2">
						<div class="container-fluid">
							<div class="row">
								<div class="col-md-12">
									<table class="table">
										<thead>
											<tr>
												<th>
													姓名
												</th>
												<th>
													理由
												</th>
												<th>
													返回日期
												</th>
												<th>
													头像
												</th>
											</tr>
										</thead>
										<tbody>
											{% for i in myData.absent %}
												<tr class="info">
													<td>
														{{ i.name }}
													</td>
													<td>
														{{ i.info }}
													</td>
													<td>
														{{ i.retime }}
													</td>
													<td>
														<img alt="90x90" height="90" width="90" src="data:image/jpg;base64,{{i.face}}" />
													</td>
												</tr>
												{% endfor %}
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
					<div class="tab-pane" id="tab3">
						<div class="container-fluid">
							<div class="row">
								<div class="col-md-12">
									<table class="table">
										<thead>
											<tr>
												<th>
													姓名
												</th>
												<th>
													理由
												</th>
												<th>
													请假日期
												</th>
												<th>
													返回日期
												</th>
												<th>
													头像
												</th>
												<th>
													操作
												</th>
											</tr>
										</thead>
										<tbody>
											{% for i in myData.inspect %}
												<tr class="info">
													<td>
														{{ i.name }}
													</td>
													<td>
														{{ i.info }}
													</td>
													<td>
														{{ i.abtime }}
													</td>
													<td>
														{{ i.retime }}
													</td>
													<td>
														<img alt="90x90" height="90" width="90" src="data:image/jpg;base64,{{i.face}}" />
													</td>
													<td>
														<button type="button" onclick="inspect('{{ i.id }}','1')" class="btn btn-xs btn-primary">通过</button>|<button type="button" onclick="inspect('{{ i.id }}','-1')" class="btn btn-xs btn-danger">拒绝</button>
													</td>
												</tr>
												{% endfor %}
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
					<div class="tab-pane" id="tab4">
							<div class="container-fluid">
									<div class="row">
										<div class="col-md-12">
											<div id="card-725641">
												<div class="card">
													<div class="card-header">
														 <a class="card-link" data-toggle="collapse" data-parent="#card-725641" href="#card-element-843716">{{ myData.week_report.week }}</a>
													</div>
													<div id="card-element-843716" class="collapse show">
														<div class="card-body">
																<div class="container-fluid">
																		<div class="row">
																			<div class="col-md-12">
																				<table class="table">
																					<thead>
																						<tr>
																							<th>
																								姓名
																							</th>
																							<th>
																								提交时间
																							</th>
																							<th>
																								内容
																							</th>
																						</tr>
																					</thead>
																					<tbody>
																						{% for i in myData.week_report.info %}
																						<tr>
																							<td>
																								{{ i.name.split("@")[-1][-4:] }}
																							</td>
																							<td>
																								{{ i.subtime }}
																							</td>
																							<td>
																								{{ i.did }}<br>
																								{{ i.trouble }}<br>
																								{{ i.want }}
																							</td>
																						</tr>
																						{%endfor%}
																					</tbody>
																				</table>
																			</div>
																		</div>
																	</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<script src="/static/new/js/jquery.min.js"></script>
<script src="/static/new/js/bootstrap.min.js"></script>
<script src="/static/new/js/scripts.js"></script>
<script>
	function inspect(abid,op){
		$.ajax( {
			url:"{{ url_for('api') }}",
			type: "POST",
			data: {"abid":abid,"op":op,"api":"absent_inspect"},
			dataType: "json",
			//processData:false,
			//contentType: false,
	
			success: function(data){
				if (data.status == "1"){
					window.location.href="{{ url_for('admin') }}";
				}else if(data.status == "-1"){
					alert("没有权限进行此操作！");
				}
			},
			error: function(){
				alert("网络连接错误!");
			}
		});
		}
</script>
</body>
</html>